<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ê±¸ì–´ì„œ ì§€êµ¬ í•œë°”í€´ - ê°œì¸ ê¸°ë¡ & í…ŒìŠ¤íŠ¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Pretendard:wght@400;700;900&display=swap');
        
        body { margin: 0; background: #00050a; color: white; font-family: 'Pretendard', sans-serif; overflow: hidden; height: 100dvh; touch-action: none; }
        #canvas-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
        #canvas-container::after { content: ''; position: absolute; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.2); pointer-events: none; }

        .ui-overlay { position: relative; z-index: 10; pointer-events: none; height: 100%; display: flex; flex-direction: column; justify-content: space-between; padding: 3rem 1.5rem; }
        .interactive { pointer-events: auto; }
        .title-font { font-family: 'Black Han Sans', sans-serif; }
        .glass { background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.2); }
        input { text-align: center; }
    </style>
</head>
<body>

    <div id="canvas-container"></div>

    <div class="fixed top-8 right-8 z-20 text-right interactive">
        <p class="text-xs text-slate-400 font-bold tracking-widest uppercase mb-1 drop-shadow-md">Target: 06.19</p>
        <div id="dday-text" class="title-font text-4xl text-yellow-400 drop-shadow-[0_2px_10px_rgba(0,0,0,0.8)]">D-Day</div>
    </div>

    <div class="fixed bottom-8 left-8 z-20 interactive">
        <button onclick="runStressTest()" class="bg-slate-700/50 hover:bg-slate-600/50 text-white/70 text-xs font-bold py-2 px-4 rounded-full backdrop-blur-md transition-colors">
            TEST: 1000ëª… ì‹œë®¬ë ˆì´ì…˜
        </button>
    </div>

    <div class="ui-overlay">
        <div class="text-center mt-10 md:mt-0">
            <p id="user-greeting" class="text-yellow-400 text-sm md:text-lg font-bold tracking-[0.2em] mb-2 title-font drop-shadow-lg">ë‚˜ì˜ ì§€êµ¬ ì—¬í–‰</p>
            
            <div class="flex items-center justify-center gap-3 drop-shadow-xl">
                <h1 class="title-font text-6xl md:text-8xl">
                    <span id="dist-text">0.00</span><span class="text-xl text-slate-400 ml-1 font-sans">km</span>
                </h1>
                <div class="flex flex-col items-start pt-2">
                    <span id="percent-text" class="text-2xl md:text-3xl font-black text-yellow-400">0.00%</span>
                    <span class="text-[10px] text-slate-400 font-bold uppercase tracking-tighter">ë‚´ ëª©í‘œ ë‹¬ì„±ë¥ </span>
                </div>
            </div>
             <p id="target-display" class="text-slate-500 text-sm mt-2 font-medium">ëª©í‘œ ê±°ë¦¬: <span id="target-km-text">40,075</span>km</p>
        </div>

        <div class="w-full max-w-md mx-auto space-y-4 text-center mb-8 md:mb-0">
            <button onclick="startRecordFlow()" class="interactive w-full py-6 bg-yellow-400 text-black rounded-2xl font-black text-2xl shadow-[0_10px_30px_rgba(250,204,21,0.4)] active:scale-95 transition-transform hover:bg-yellow-300">
                ê¸°ë¡ ì¶”ê°€í•˜ê¸°
            </button>
        </div>
    </div>

    <div id="modal-backdrop" class="fixed inset-0 z-50 hidden flex items-center justify-center p-6 bg-black/80 backdrop-blur-md transition-opacity">
        
        <div id="login-modal" class="interactive glass w-full max-w-sm p-8 rounded-[40px] text-white text-center shadow-2xl border-yellow-400/30 hidden">
            <h3 class="title-font text-3xl mb-6 text-yellow-400">ë³¸ì¸ í™•ì¸</h3>
            <p class="text-slate-400 text-sm mb-8">ê¸°ë¡ì„ ê´€ë¦¬í•  ì´ë¦„ê³¼ ì—°ë½ì²˜ ë’·ìë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
            <div class="space-y-5 mb-8">
                <input type="text" id="loginName" placeholder="ì´ë¦„ (ì˜ˆ: í™ê¸¸ë™)" class="w-full bg-white/10 border border-white/20 rounded-xl p-4 outline-none focus:border-yellow-400 font-bold text-white">
                <input type="tel" id="loginPhone" maxlength="4" placeholder="íœ´ëŒ€í° ë’· 4ìë¦¬" class="w-full bg-white/10 border border-white/20 rounded-xl p-4 outline-none focus:border-yellow-400 font-bold text-white">
            </div>
            <div class="flex gap-4">
                <button onclick="closeAllModals()" class="flex-1 py-4 font-bold text-slate-400 hover:text-white transition-colors">ì·¨ì†Œ</button>
                <button onclick="handleLogin()" class="flex-1 py-4 bg-yellow-400 text-black rounded-2xl font-black shadow-lg hover:bg-yellow-300 transition-colors">í™•ì¸</button>
            </div>
        </div>

        <div id="register-modal" class="interactive glass w-full max-w-sm p-8 rounded-[40px] text-white text-center shadow-2xl border-yellow-400/30 hidden">
            <h3 class="title-font text-2xl mb-4 text-yellow-400">í™˜ì˜í•©ë‹ˆë‹¤! ğŸ‰</h3>
            <p class="text-slate-300 mb-8 break-keep leading-relaxed">ì²˜ìŒ ì˜¤ì…¨êµ°ìš”!<br>ì´ë²ˆ ì—¬ì •ì˜ <strong>ìµœì¢… ëª©í‘œ ê±°ë¦¬</strong>ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.</p>
            <div class="mb-8">
                 <label class="text-xs text-slate-400 mb-2 block uppercase tracking-widest">ëª©í‘œ ê±°ë¦¬ (KM)</label>
                <input type="number" id="targetKmInput" placeholder="ì˜ˆ: 1000" class="w-full bg-white/10 border border-white/20 rounded-2xl p-5 outline-none focus:border-yellow-400 text-3xl font-bold text-white">
                 <p class="text-xs text-slate-500 mt-2">*ì§€êµ¬ í•œë°”í€´ëŠ” ì•½ 40,075km ì…ë‹ˆë‹¤.</p>
            </div>
             <button onclick="handleRegister()" class="w-full py-4 bg-yellow-400 text-black rounded-2xl font-black shadow-lg hover:bg-yellow-300 transition-colors">ëª©í‘œ ì„¤ì • ì™„ë£Œ</button>
        </div>

        <div id="record-modal" class="interactive glass w-full max-w-sm p-8 rounded-[40px] text-white text-center shadow-2xl border-yellow-400/30 hidden">
            <h3 class="title-font text-2xl mb-2 text-yellow-400"><span id="current-username"></span>ë‹˜ì˜ ê¸°ë¡</h3>
             <p class="text-slate-400 text-sm mb-8">ì˜¤ëŠ˜ ì–¼ë§ˆë‚˜ ê±¸ìœ¼ì…¨ë‚˜ìš”?</p>
            <div class="space-y-6">
                <div>
                    <label class="text-xs text-slate-400 mb-2 block uppercase tracking-widest">ë‚ ì§œ ì„ íƒ</label>
                    <input type="date" id="inputDate" class="w-full bg-white/10 border border-white/20 rounded-2xl p-4 outline-none focus:border-yellow-400 text-lg font-bold text-white">
                </div>
                <div>
                    <label class="text-xs text-slate-400 mb-2 block uppercase tracking-widest">ì´ë™ ê±°ë¦¬ (KM)</label>
                    <input type="number" id="inputKm" step="0.1" placeholder="0.0" class="w-full bg-white/10 border border-white/20 rounded-2xl p-5 outline-none focus:border-yellow-400 text-4xl font-bold text-white">
                </div>
            </div>
            <div class="flex gap-4 mt-10">
                <button onclick="closeAllModals()" class="flex-1 py-4 font-bold text-slate-400 hover:text-white transition-colors">ì·¨ì†Œ</button>
                <button onclick="submitRecord()" class="flex-1 py-4 bg-yellow-400 text-black rounded-2xl font-black shadow-lg hover:bg-yellow-300 transition-colors">ì €ì¥</button>
            </div>
        </div>
    </div>

    <div id="bible-modal" onclick="closeBible()" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-10 bg-black/90 backdrop-blur-2xl cursor-pointer">
        <div class="max-w-lg text-center pointer-events-none drop-shadow-2xl">
            <div class="w-16 h-1 bg-yellow-400 mx-auto mb-10 shadow-[0_0_20px_rgba(250,204,21,0.8)]"></div>
            <p id="bible-text" class="text-3xl md:text-5xl font-black leading-tight text-white mb-8 break-keep"></p>
            <p id="bible-ref" class="text-yellow-400 font-bold tracking-[0.2em] text-lg uppercase"></p>
        </div>
    </div>

    <script>
        // === ì „ì—­ ë³€ìˆ˜ ë° ë°ì´í„° ê´€ë¦¬ ===
        let scene, camera, renderer, globe, marker, controls, pathTube;
        const EARTH_CIRCUMFERENCE = 40075; 
        const GLOBE_RADIUS = 2;
        const PATH_RADIUS = 2.15;

        let appData = JSON.parse(localStorage.getItem('earthWalkDataV2')) || { users: {} };
        let currentUser = null;
        let isTestRunning = false; // í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ìƒíƒœ

        function saveAppData() {
            localStorage.setItem('earthWalkDataV2', JSON.stringify(appData));
        }

        // === 3D Scene ì´ˆê¸°í™” ===
        function init3D() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 1.2; 
            document.getElementById('canvas-container').appendChild(renderer.domElement);

            const textureLoader = new THREE.TextureLoader();
            scene.background = textureLoader.load('countdown.jpg', undefined, undefined, (err) => {
                scene.background = new THREE.Color(0x00050a);
            });

            // ì¡°ëª… ì±„ë„ ë° ë°ê¸° ê°•í™”
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.95); // í™˜ê²½ê´‘ ëŒ€í­ ê°•í™”
            scene.add(ambientLight);
            const sunLight = new THREE.DirectionalLight(0xffffff, 2.2); // ì£¼ê´‘ ê°•í™”
            sunLight.position.set(5, 3, 5);
            scene.add(sunLight);
            const backLight = new THREE.DirectionalLight(0xaaaaff, 1.0); // í›„ë©´ê´‘ ê°•í™”
            backLight.position.set(-5, -1, -5);
            scene.add(backLight);


            const earthTexture = textureLoader.load('https://unpkg.com/three-globe/example/img/earth-blue-marble.jpg');
            // ì§€êµ¬ ì¬ì§ˆ: ë” ê¸ˆì†ì„± ìˆê³  ë°˜ì§ì´ê²Œ
            globe = new THREE.Mesh(
                new THREE.SphereGeometry(GLOBE_RADIUS, 64, 64), 
                new THREE.MeshStandardMaterial({ 
                    map: earthTexture,
                    roughness: 0.4, 
                    metalness: 0.3,
                    emissive: 0x222244,
                })
            );
            scene.add(globe);

            marker = new THREE.Group();
            const glow = new THREE.Sprite(new THREE.SpriteMaterial({
                map: textureLoader.load('https://threejs.org/examples/textures/lensflare/lensflare0.png'),
                color: 0xfff000, transparent: true, blending: THREE.AdditiveBlending
            }));
            glow.scale.set(0.8, 0.8, 1);
            marker.add(glow);
            scene.add(marker);

            camera.position.z = 6.5;
            
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.enableZoom = false;
            controls.autoRotate = false; 

            document.getElementById('inputDate').value = new Date().toISOString().substring(0, 10);

            updateDDay();
            updateVisuals(0, EARTH_CIRCUMFERENCE); 
            animate();
        }

        // === UI ë° ë¡œì§ í•¨ìˆ˜ ===

        function updateDDay() {
            const target = new Date(2026, 5, 19);
            const today = new Date();
            target.setHours(0,0,0,0); today.setHours(0,0,0,0);
            const diff = target - today;
            const days = Math.ceil(diff / (1000 * 60 * 60 * 24));
            const display = days === 0 ? "D-Day" : (days > 0 ? `D-${days}` : `D+${Math.abs(days)}`);
            document.getElementById('dday-text').innerText = display;
        }

        function updateVisuals(currentKm, targetKm) {
            const safeTarget = targetKm || EARTH_CIRCUMFERENCE;
            const ratio = Math.min(currentKm / safeTarget, 1);
            const percent = (ratio * 100).toFixed(2);
            
            if (pathTube) scene.remove(pathTube);
            
            if (ratio > 0) {
                const points = [];
                // ê¶¤ì ì€ í•­ìƒ ì§€êµ¬ ì „ì²´ ë‘˜ë ˆë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°
                const arcRatio = Math.min(currentKm / EARTH_CIRCUMFERENCE, 1);
                const segments = Math.max(2, Math.floor(arcRatio * 200));
                for (let i = 0; i <= segments; i++) {
                    const pRatio = (i / segments) * arcRatio;
                    const angle = Math.PI - (pRatio * Math.PI * 2);
                    points.push(new THREE.Vector3(Math.cos(angle) * PATH_RADIUS, Math.sin(angle) * PATH_RADIUS, 0));
                }

                const pathCurve = new THREE.CatmullRomCurve3(points);
                const tubeGeo = new THREE.TubeGeometry(pathCurve, 128, 0.02, 8, false);
                // ë¹›ì˜ ê¶¤ì  ë°œê´‘ ê°•ë„ ê°•í™” (2.0 -> 3.0)
                const tubeMat = new THREE.MeshStandardMaterial({ 
                    color: 0xfacc15,
                    emissive: 0xfacc15,
                    emissiveIntensity: 3.0, 
                    roughness: 0.2
                });
                pathTube = new THREE.Mesh(tubeGeo, tubeMat);
                scene.add(pathTube);

                const lastPoint = points[points.length - 1];
                marker.position.copy(lastPoint);
                marker.visible = true;
            } else {
                marker.position.set(-PATH_RADIUS, 0, 0);
            }

            // í…ŒìŠ¤íŠ¸ ì¤‘ì¼ ë•ŒëŠ” ì†Œìˆ˜ì  ì—†ì´ ì •ìˆ˜ë¡œ í‘œì‹œ
            const fractionDigits = isTestRunning ? 0 : 2;
            document.getElementById('dist-text').innerText = currentKm.toLocaleString(undefined, {minimumFractionDigits: fractionDigits, maximumFractionDigits: fractionDigits});
            document.getElementById('percent-text').innerText = percent + "%";
            
            if(!isTestRunning) {
                 if(currentUser) {
                    document.getElementById('user-greeting').innerText = `${currentUser.name}ë‹˜ì˜ ì§€êµ¬ ì—¬í–‰`;
                    document.getElementById('target-km-text').innerText = currentUser.targetKm.toLocaleString();
                } else {
                     document.getElementById('user-greeting').innerText = "ë‚˜ì˜ ì§€êµ¬ ì—¬í–‰";
                     document.getElementById('target-km-text').innerText = EARTH_CIRCUMFERENCE.toLocaleString();
                }
            }
        }

        // === ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ ===
        function runStressTest() {
            if (isTestRunning) return;
            isTestRunning = true;
            console.log("Starting 1000 User Stress Test...");
            document.getElementById('user-greeting').innerText = "TEST RUNNING: Global Total";
            document.getElementById('target-km-text').innerText = "Many Many";

            const startTime = Date.now();
            let submissions = 0;
            const totalSubmissions = 1000;
            const duration = 30000; // 30ì´ˆ
            const intervalTime = duration / totalSubmissions; // ì•½ 30ms ë§ˆë‹¤ ì‹¤í–‰

            // 1. ë”ë¯¸ ì‚¬ìš©ì ìƒì„± (ì—†ì„ ê²½ìš°)
            for (let i = 0; i < 1000; i++) {
                const userId = `test_user_${i}`;
                if (!appData.users[userId]) {
                    appData.users[userId] = { id: userId, name: `Tester ${i}`, phone: '0000', totalKm: 0, targetKm: EARTH_CIRCUMFERENCE };
                }
            }
            // í…ŒìŠ¤íŠ¸ ì‹œì‘ ì „ ì €ì¥ í•œë²ˆ ìˆ˜í–‰
            saveAppData();

            // 2. ì œì¶œ ë£¨í”„ ì‹œì‘
            const testInterval = setInterval(() => {
                submissions++;
                if (submissions > totalSubmissions) {
                    clearInterval(testInterval);
                    finishStressTest(startTime);
                    return;
                }

                // ëœë¤ ì‚¬ìš©ì ì„ íƒ ë° ë°ì´í„° ì¶”ê°€
                const randomUserIndex = Math.floor(Math.random() * 1000);
                const userId = `test_user_${randomUserIndex}`;
                appData.users[userId].totalKm += Math.floor(Math.random() * 15) + 1;
                
                // ë§¤ë²ˆ ì €ì¥ì„ ì‹œë®¬ë ˆì´ì…˜ (ë¶€í•˜ í…ŒìŠ¤íŠ¸ ëª©ì )
                saveAppData(); 

                // ì „ì²´ í•©ê³„ ê³„ì‚° (ì‹œê°ì  í”¼ë“œë°±ìš©)
                let globalTotal = 0;
                Object.values(appData.users).forEach(u => globalTotal += u.totalKm);

                // í™”ë©´ ì—…ë°ì´íŠ¸ (requestAnimationFrameìœ¼ë¡œ UI ë¸”ë¡œí‚¹ ë°©ì§€ ì‹œë„)
                requestAnimationFrame(() => {
                     // í…ŒìŠ¤íŠ¸ ì¤‘ì—ëŠ” ëª©í‘œë¥¼ ë§¤ìš° í¬ê²Œ ì¡ì•„ ê¶¤ì ì´ ë„ˆë¬´ ë¹¨ë¦¬ ì°¨ì§€ ì•Šê²Œ í•¨
                     updateVisuals(globalTotal, EARTH_CIRCUMFERENCE * 10);
                     document.getElementById('percent-text').innerText = `${submissions}/${totalSubmissions}`;
                });

            }, intervalTime);
        }

        function finishStressTest(startTime) {
            isTestRunning = false;
            const endTime = Date.now();
            console.log(`Test Finished! 1000 submissions in ${(endTime - startTime) / 1000}s.`);
            alert("í…ŒìŠ¤íŠ¸ ì™„ë£Œ! ì½˜ì†”ì°½ì—ì„œ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”.");
            // ì›ë˜ í™”ë©´ìœ¼ë¡œ ë³µê·€
            if (currentUser) updateVisuals(currentUser.totalKm, currentUser.targetKm);
            else updateVisuals(0, EARTH_CIRCUMFERENCE);
        }


        // === ì‚¬ìš©ì íë¦„ (Flow) ê´€ë ¨ í•¨ìˆ˜ ===
        function startRecordFlow() {
            document.getElementById('loginName').value = "";
            document.getElementById('loginPhone').value = "";
            currentUser = null;
            showModal('login');
        }

        function handleLogin() {
            const name = document.getElementById('loginName').value.trim();
            const phone = document.getElementById('loginPhone').value.trim();
            if (!name || phone.length !== 4) { alert("ì´ë¦„ê³¼ íœ´ëŒ€í° ë’· 4ìë¦¬ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”."); return; }
            const userKey = `${name}_${phone}`;
            if (appData.users[userKey]) {
                currentUser = appData.users[userKey];
                prepareRecordModal();
            } else {
                currentUser = { id: userKey, name: name, phone: phone, totalKm: 0, targetKm: EARTH_CIRCUMFERENCE };
                showModal('register');
            }
        }

        function handleRegister() {
            const targetInput = document.getElementById('targetKmInput');
            const targetKm = parseFloat(targetInput.value);
            if (!targetKm || targetKm <= 0) { alert("ì˜¬ë°”ë¥¸ ëª©í‘œ ê±°ë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."); return; }
            currentUser.targetKm = targetKm;
            appData.users[currentUser.id] = currentUser;
            saveAppData();
            updateVisuals(currentUser.totalKm, currentUser.targetKm);
            prepareRecordModal();
        }

        function prepareRecordModal() {
            document.getElementById('current-username').innerText = currentUser.name;
            document.getElementById('inputKm').value = "";
            showModal('record');
        }

        function submitRecord() {
            if (!currentUser) return;
            const kmInput = document.getElementById('inputKm');
            let addedKm = parseFloat(kmInput.value) || 0;
            if (addedKm <= 0) { closeAllModals(); return; }
            const startKm = currentUser.totalKm;
            currentUser.totalKm += addedKm;
            appData.users[currentUser.id] = currentUser;
            saveAppData();
            closeAllModals();
            gsap.to({ val: startKm }, {
                val: currentUser.totalKm, duration: 2.0, ease: "power3.inOut",
                onUpdate: function() { updateVisuals(this.targets()[0].val, currentUser.targetKm); },
                onComplete: () => {
                    gsap.fromTo(marker.scale, {x:1, y:1}, {x:2.5, y:2.5, duration: 0.5, yoyo:true, repeat:1, ease:"back.out(2)"});
                    setTimeout(showBibleVerse, 800);
                }
            });
        }

        // === ëª¨ë‹¬ ê´€ë¦¬ ìœ í‹¸ë¦¬í‹° ===
        function showModal(modalName) {
            document.getElementById('modal-backdrop').classList.remove('hidden');
            ['login', 'register', 'record'].forEach(name => {
                const el = document.getElementById(`${name}-modal`);
                if (name === modalName) el.classList.remove('hidden');
                else el.classList.add('hidden');
            });
        }

        function closeAllModals() {
            document.getElementById('modal-backdrop').classList.add('hidden');
            document.querySelectorAll('#modal-backdrop > div').forEach(el => el.classList.add('hidden'));
        }

        // === ê¸°íƒ€ ê¸°ëŠ¥ ===
        function showBibleVerse() {
            const verses = [
                { text: "ì´ê¸°ê¸°ë¥¼ ë‹¤íˆ¬ëŠ” ìë§ˆë‹¤ ëª¨ë“  ì¼ì— ì ˆì œí•˜ë‚˜ë‹ˆ", ref: "ê³ ë¦°ë„ì „ì„œ 9:25" },
                { text: "ë‚´ê°€ ì„ í•œ ì‹¸ì›€ì„ ì‹¸ìš°ê³  ë‚˜ì˜ ë‹¬ë ¤ê°ˆ ê¸¸ì„ ë§ˆì³¤ìœ¼ë‹ˆ", ref: "ë””ëª¨ë°í›„ì„œ 4:7" },
                { text: "í‘¯ëŒ€ë¥¼ í–¥í•˜ì—¬ ê·¸ë¦¬ìŠ¤ë„ ì˜ˆìˆ˜ ì•ˆì—ì„œ ë‹¬ë ¤ê°€ë…¸ë¼", ref: "ë¹Œë¦½ë³´ì„œ 3:14" },
                { text: "ì¸ë‚´ë¡œì¨ ìš°ë¦¬ ì•ì— ë‹¹í•œ ê²½ì£¼ë¥¼ í•˜ë©°", ref: "íˆë¸Œë¦¬ì„œ 12:1" }
            ];
            const v = verses[Math.floor(Math.random() * verses.length)];
            document.getElementById('bible-text').innerText = v.text;
            document.getElementById('bible-ref').innerText = v.ref;
            document.getElementById('bible-modal').classList.remove('hidden');
        }

        function closeBible() { document.getElementById('bible-modal').classList.add('hidden'); }

        // === ë©”ì¸ ë£¨í”„ ===
        function animate() { 
            requestAnimationFrame(animate); 
            // ì§€êµ¬ê°€ ìŠ¤ìŠ¤ë¡œ íšŒì „ (ë¹›ì˜ ê¶¤ì ì€ ê³ ì •)
            if(globe) globe.rotation.y -= 0.0015; 
            controls.update(); 
            renderer.render(scene, camera); 
        }

        window.addEventListener('resize', () => { 
            camera.aspect = window.innerWidth / window.innerHeight; 
            camera.updateProjectionMatrix(); 
            renderer.setSize(window.innerWidth, window.innerHeight); 
        });

        init3D();
    </script>
</body>
</html>
