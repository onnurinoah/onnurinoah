<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ê±¸ì–´ì„œ ì§€êµ¬ í•œë°”í€´ - ê°œì¸ ê¸°ë¡</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Pretendard:wght@400;700;900&display=swap');
        
        body { margin: 0; background: #00050a; color: white; font-family: 'Pretendard', sans-serif; overflow: hidden; height: 100dvh; touch-action: none; }
        #canvas-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
        /* ë°°ê²½ ë°ê¸° ì¡°ì ˆìš© ì˜¤ë²„ë ˆì´ (í•„ìš”ì‹œ opacity ì¡°ì ˆ) */
        #canvas-container::after { content: ''; position: absolute; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.2); pointer-events: none; }

        .ui-overlay { position: relative; z-index: 10; pointer-events: none; height: 100%; display: flex; flex-direction: column; justify-content: space-between; padding: 3rem 1.5rem; }
        .interactive { pointer-events: auto; }
        .title-font { font-family: 'Black Han Sans', sans-serif; }
        .glass { background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.2); }
        input { text-align: center; }
    </style>
</head>
<body>

    <div id="canvas-container"></div>

    <div class="fixed top-8 right-8 z-20 text-right interactive">
        <p class="text-xs text-slate-400 font-bold tracking-widest uppercase mb-1 drop-shadow-md">Target: 06.19</p>
        <div id="dday-text" class="title-font text-4xl text-yellow-400 drop-shadow-[0_2px_10px_rgba(0,0,0,0.8)]">D-Day</div>
    </div>

    <div class="ui-overlay">
        <div class="text-center mt-10 md:mt-0">
            <p id="user-greeting" class="text-yellow-400 text-sm md:text-lg font-bold tracking-[0.2em] mb-2 title-font drop-shadow-lg">ë‚˜ì˜ ì§€êµ¬ ì—¬í–‰</p>
            
            <div class="flex items-center justify-center gap-3 drop-shadow-xl">
                <h1 class="title-font text-6xl md:text-8xl">
                    <span id="dist-text">0.00</span><span class="text-xl text-slate-400 ml-1 font-sans">km</span>
                </h1>
                <div class="flex flex-col items-start pt-2">
                    <span id="percent-text" class="text-2xl md:text-3xl font-black text-yellow-400">0.00%</span>
                    <span class="text-[10px] text-slate-400 font-bold uppercase tracking-tighter">ë‚´ ëª©í‘œ ë‹¬ì„±ë¥ </span>
                </div>
            </div>
             <p id="target-display" class="text-slate-500 text-sm mt-2 font-medium">ëª©í‘œ ê±°ë¦¬: <span id="target-km-text">0</span>km</p>
        </div>

        <div class="w-full max-w-md mx-auto space-y-4 text-center mb-8 md:mb-0">
            <button onclick="startRecordFlow()" class="interactive w-full py-6 bg-yellow-400 text-black rounded-2xl font-black text-2xl shadow-[0_10px_30px_rgba(250,204,21,0.4)] active:scale-95 transition-transform hover:bg-yellow-300">
                ê¸°ë¡ ì¶”ê°€í•˜ê¸°
            </button>
        </div>
    </div>

    <div id="modal-backdrop" class="fixed inset-0 z-50 hidden flex items-center justify-center p-6 bg-black/80 backdrop-blur-md transition-opacity">
        
        <div id="login-modal" class="interactive glass w-full max-w-sm p-8 rounded-[40px] text-white text-center shadow-2xl border-yellow-400/30 hidden">
            <h3 class="title-font text-3xl mb-6 text-yellow-400">ë³¸ì¸ í™•ì¸</h3>
            <p class="text-slate-400 text-sm mb-8">ê¸°ë¡ì„ ê´€ë¦¬í•  ì´ë¦„ê³¼ ì—°ë½ì²˜ ë’·ìë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
            <div class="space-y-5 mb-8">
                <input type="text" id="loginName" placeholder="ì´ë¦„ (ì˜ˆ: í™ê¸¸ë™)" class="w-full bg-white/10 border border-white/20 rounded-xl p-4 outline-none focus:border-yellow-400 font-bold text-white">
                <input type="tel" id="loginPhone" maxlength="4" placeholder="íœ´ëŒ€í° ë’· 4ìë¦¬" class="w-full bg-white/10 border border-white/20 rounded-xl p-4 outline-none focus:border-yellow-400 font-bold text-white">
            </div>
            <div class="flex gap-4">
                <button onclick="closeAllModals()" class="flex-1 py-4 font-bold text-slate-400 hover:text-white transition-colors">ì·¨ì†Œ</button>
                <button onclick="handleLogin()" class="flex-1 py-4 bg-yellow-400 text-black rounded-2xl font-black shadow-lg hover:bg-yellow-300 transition-colors">í™•ì¸</button>
            </div>
        </div>

        <div id="register-modal" class="interactive glass w-full max-w-sm p-8 rounded-[40px] text-white text-center shadow-2xl border-yellow-400/30 hidden">
            <h3 class="title-font text-2xl mb-4 text-yellow-400">í™˜ì˜í•©ë‹ˆë‹¤! ğŸ‰</h3>
            <p class="text-slate-300 mb-8 break-keep leading-relaxed">ì²˜ìŒ ì˜¤ì…¨êµ°ìš”!<br>ì´ë²ˆ ì—¬ì •ì˜ <strong>ìµœì¢… ëª©í‘œ ê±°ë¦¬</strong>ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.</p>
            <div class="mb-8">
                 <label class="text-xs text-slate-400 mb-2 block uppercase tracking-widest">ëª©í‘œ ê±°ë¦¬ (KM)</label>
                <input type="number" id="targetKmInput" placeholder="ì˜ˆ: 1000" class="w-full bg-white/10 border border-white/20 rounded-2xl p-5 outline-none focus:border-yellow-400 text-3xl font-bold text-white">
                 <p class="text-xs text-slate-500 mt-2">*ì§€êµ¬ í•œë°”í€´ëŠ” ì•½ 40,075km ì…ë‹ˆë‹¤.</p>
            </div>
             <button onclick="handleRegister()" class="w-full py-4 bg-yellow-400 text-black rounded-2xl font-black shadow-lg hover:bg-yellow-300 transition-colors">ëª©í‘œ ì„¤ì • ì™„ë£Œ</button>
        </div>

        <div id="record-modal" class="interactive glass w-full max-w-sm p-8 rounded-[40px] text-white text-center shadow-2xl border-yellow-400/30 hidden">
            <h3 class="title-font text-2xl mb-2 text-yellow-400"><span id="current-username"></span>ë‹˜ì˜ ê¸°ë¡</h3>
             <p class="text-slate-400 text-sm mb-8">ì˜¤ëŠ˜ ì–¼ë§ˆë‚˜ ê±¸ìœ¼ì…¨ë‚˜ìš”?</p>
            <div class="space-y-6">
                <div>
                    <label class="text-xs text-slate-400 mb-2 block uppercase tracking-widest">ë‚ ì§œ ì„ íƒ</label>
                    <input type="date" id="inputDate" class="w-full bg-white/10 border border-white/20 rounded-2xl p-4 outline-none focus:border-yellow-400 text-lg font-bold text-white">
                </div>
                <div>
                    <label class="text-xs text-slate-400 mb-2 block uppercase tracking-widest">ì´ë™ ê±°ë¦¬ (KM)</label>
                    <input type="number" id="inputKm" step="0.1" placeholder="0.0" class="w-full bg-white/10 border border-white/20 rounded-2xl p-5 outline-none focus:border-yellow-400 text-4xl font-bold text-white">
                </div>
            </div>
            <div class="flex gap-4 mt-10">
                <button onclick="closeAllModals()" class="flex-1 py-4 font-bold text-slate-400 hover:text-white transition-colors">ì·¨ì†Œ</button>
                <button onclick="submitRecord()" class="flex-1 py-4 bg-yellow-400 text-black rounded-2xl font-black shadow-lg hover:bg-yellow-300 transition-colors">ì €ì¥</button>
            </div>
        </div>
    </div>


    <div id="bible-modal" onclick="closeBible()" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-10 bg-black/90 backdrop-blur-2xl cursor-pointer">
        <div class="max-w-lg text-center pointer-events-none drop-shadow-2xl">
            <div class="w-16 h-1 bg-yellow-400 mx-auto mb-10 shadow-[0_0_20px_rgba(250,204,21,0.8)]"></div>
            <p id="bible-text" class="text-3xl md:text-5xl font-black leading-tight text-white mb-8 break-keep"></p>
            <p id="bible-ref" class="text-yellow-400 font-bold tracking-[0.2em] text-lg uppercase"></p>
        </div>
    </div>

    <script>
        // === ì „ì—­ ë³€ìˆ˜ ë° ë°ì´í„° ê´€ë¦¬ ===
        let scene, camera, renderer, globe, marker, controls, pathTube;
        const EARTH_CIRCUMFERENCE = 40075; 
        const GLOBE_RADIUS = 2;
        const PATH_RADIUS = 2.15;

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì „ì²´ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (ì—†ìœ¼ë©´ ì´ˆê¸°í™”)
        let appData = JSON.parse(localStorage.getItem('earthWalkDataV2')) || { users: {} };
        let currentUser = null; // í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´ ê°ì²´

        function saveAppData() {
            localStorage.setItem('earthWalkDataV2', JSON.stringify(appData));
        }

        // === 3D Scene ì´ˆê¸°í™” ===
        function init3D() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            // í†¤ ë§¤í•‘ ë…¸ì¶œì„ ë†’ì—¬ì„œ ì „ì²´ì ìœ¼ë¡œ ë°ê²Œ ì„¤ì •
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 1.2; 
            document.getElementById('canvas-container').appendChild(renderer.domElement);

            const textureLoader = new THREE.TextureLoader();
            // ë°°ê²½ ì´ë¯¸ì§€ ë¡œë“œ (countdown.jpgê°€ ê°™ì€ í´ë”ì— ìˆì–´ì•¼ í•¨)
            scene.background = textureLoader.load('countdown.jpg', undefined, undefined, (err) => {
                console.error("ë°°ê²½ ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨ (countdown.jpg í™•ì¸ í•„ìš”)", err);
                scene.background = new THREE.Color(0x00050a); // ì‹¤íŒ¨ ì‹œ ê¸°ë³¸ ë°°ê²½ìƒ‰
            });

            // ì¡°ëª… ë°ê¸° ê°•í™”
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.8); // í™˜ê²½ê´‘ ê°•í™”
            scene.add(ambientLight);
            const sunLight = new THREE.DirectionalLight(0xffffff, 2.0); // ì£¼ê´‘ ê°•í™”
            sunLight.position.set(5, 3, 5);
            scene.add(sunLight);
            const backLight = new THREE.DirectionalLight(0xaaaaff, 0.8); // í›„ë©´ê´‘ ê°•í™”
            backLight.position.set(-5, -1, -5);
            scene.add(backLight);


            const earthTexture = textureLoader.load('https://unpkg.com/three-globe/example/img/earth-blue-marble.jpg');
            // ì§€êµ¬ ì¬ì§ˆ ì¡°ì •: ë” ë°ê³  ë°˜ì§ì´ê²Œ
            globe = new THREE.Mesh(
                new THREE.SphereGeometry(GLOBE_RADIUS, 64, 64), 
                new THREE.MeshStandardMaterial({ 
                    map: earthTexture,
                    roughness: 0.3, // ê±°ì¹ ê¸° ê°ì†Œ (ë” ë§¤ëˆí•˜ê²Œ)
                    metalness: 0.2,  // ê¸ˆì†ì„± ì•½ê°„ ì¦ê°€ (ë°˜ì‚¬ê´‘)
                    emissive: 0x222244, // ìì²´ ë°œê´‘ìƒ‰ ì¶”ê°€í•˜ì—¬ ì–´ë‘ìš´ ë¶€ë¶„ ë³´ì™„
                })
            );
            scene.add(globe);

            marker = new THREE.Group();
            const glow = new THREE.Sprite(new THREE.SpriteMaterial({
                map: textureLoader.load('https://threejs.org/examples/textures/lensflare/lensflare0.png'),
                color: 0xfff000, transparent: true, blending: THREE.AdditiveBlending
            }));
            glow.scale.set(0.8, 0.8, 1);
            marker.add(glow);
            scene.add(marker);

            camera.position.z = 6.5;
            
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.enableZoom = false;
            // **ì¤‘ìš”: ì¹´ë©”ë¼ ìë™ íšŒì „ ë¹„í™œì„±í™”** (ì§€êµ¬ê°€ ëŒê²Œ í•  ê²ƒì„)
            controls.autoRotate = false; 

            document.getElementById('inputDate').value = new Date().toISOString().substring(0, 10);

            updateDDay();
            // ì´ˆê¸° ìƒíƒœëŠ” 0kmë¡œ ì‹œì‘
            updateVisuals(0, EARTH_CIRCUMFERENCE); 
            animate();
        }

        // === UI ë° ë¡œì§ í•¨ìˆ˜ ===

        function updateDDay() {
            const target = new Date(2026, 5, 19); // 2026ë…„ 6ì›” 19ì¼
            const today = new Date();
            target.setHours(0,0,0,0); today.setHours(0,0,0,0);
            const diff = target - today;
            const days = Math.ceil(diff / (1000 * 60 * 60 * 24));
            
            const display = days === 0 ? "D-Day" : (days > 0 ? `D-${days}` : `D+${Math.abs(days)}`);
            document.getElementById('dday-text').innerText = display;
        }

        // 3D ë° í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ (í˜„ì¬ ì‚¬ìš©ìì˜ kmì™€ ëª©í‘œ ê¸°ì¤€)
        function updateVisuals(currentKm, targetKm) {
            const safeTarget = targetKm || EARTH_CIRCUMFERENCE; // ëª©í‘œê°€ 0ì´ë©´ ì§€êµ¬ ë‘˜ë ˆ ê¸°ì¤€
            const ratio = Math.min(currentKm / safeTarget, 1);
            const percent = (ratio * 100).toFixed(2);
            
            if (pathTube) scene.remove(pathTube);
            
            if (ratio > 0) {
                const points = [];
                // ëª©í‘œ ëŒ€ë¹„ ë¹„ìœ¨ë§Œí¼ ì›í˜¸ë¥¼ ê·¸ë¦¼ (ìµœëŒ€ 1ë°”í€´)
                const arcRatio = Math.min(currentKm / EARTH_CIRCUMFERENCE, 1);
                const segments = Math.max(2, Math.floor(arcRatio * 200));
                for (let i = 0; i <= segments; i++) {
                    const pRatio = (i / segments) * arcRatio;
                    // 9ì‹œ ë°©í–¥ ì‹œì‘, ì‹œê³„ë°©í–¥
                    const angle = Math.PI - (pRatio * Math.PI * 2);
                    points.push(new THREE.Vector3(Math.cos(angle) * PATH_RADIUS, Math.sin(angle) * PATH_RADIUS, 0));
                }

                const pathCurve = new THREE.CatmullRomCurve3(points);
                const tubeGeo = new THREE.TubeGeometry(pathCurve, 128, 0.02, 8, false);
                // ë¹› ê¶¤ì  ì¬ì§ˆ ê°•í™”
                const tubeMat = new THREE.MeshStandardMaterial({ 
                    color: 0xfacc15,
                    emissive: 0xfacc15,
                    emissiveIntensity: 2.0, // ë°œê´‘ ê°•ë„ ì¦ê°€
                    roughness: 0.2
                });
                pathTube = new THREE.Mesh(tubeGeo, tubeMat);
                scene.add(pathTube);

                const lastPoint = points[points.length - 1];
                marker.position.copy(lastPoint);
                marker.visible = true;
            } else {
                marker.position.set(-PATH_RADIUS, 0, 0);
            }

            // ë©”ì¸ UI í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            document.getElementById('dist-text').innerText = currentKm.toLocaleString(undefined, {minimumFractionDigits: 2});
            document.getElementById('percent-text').innerText = percent + "%";
            if(currentUser) {
                document.getElementById('user-greeting').innerText = `${currentUser.name}ë‹˜ì˜ ì§€êµ¬ ì—¬í–‰`;
                document.getElementById('target-km-text').innerText = currentUser.targetKm.toLocaleString();
            }
        }

        // === ì‚¬ìš©ì íë¦„ (Flow) ê´€ë ¨ í•¨ìˆ˜ ===

        // 1. "ê¸°ë¡ ì¶”ê°€í•˜ê¸°" ë²„íŠ¼ í´ë¦­ ì‹œ -> ë¡œê·¸ì¸ ëª¨ë‹¬ ì—´ê¸°
        function startRecordFlow() {
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('loginName').value = "";
            document.getElementById('loginPhone').value = "";
            currentUser = null; // ê¸°ì¡´ ë¡œê·¸ì¸ ì •ë³´ ì´ˆê¸°í™”
            showModal('login');
        }

        // 2. ë¡œê·¸ì¸ í™•ì¸
        function handleLogin() {
            const name = document.getElementById('loginName').value.trim();
            const phone = document.getElementById('loginPhone').value.trim();

            if (!name || phone.length !== 4) {
                alert("ì´ë¦„ê³¼ íœ´ëŒ€í° ë’· 4ìë¦¬ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }

            const userKey = `${name}_${phone}`; // ê³ ìœ  í‚¤ ìƒì„±

            if (appData.users[userKey]) {
                // ê¸°ì¡´ ì‚¬ìš©ì -> ê¸°ë¡ ëª¨ë‹¬ë¡œ ì´ë™
                currentUser = appData.users[userKey];
                prepareRecordModal();
            } else {
                // ì‹ ê·œ ì‚¬ìš©ì -> ë“±ë¡(ëª©í‘œ ì„¤ì •) ëª¨ë‹¬ë¡œ ì´ë™
                currentUser = { id: userKey, name: name, phone: phone, totalKm: 0, targetKm: EARTH_CIRCUMFERENCE }; // ì„ì‹œ ê°ì²´ ìƒì„±
                showModal('register');
            }
        }

        // 3. ì‹ ê·œ ì‚¬ìš©ì ë“±ë¡ ë° ëª©í‘œ ì„¤ì •
        function handleRegister() {
            const targetInput = document.getElementById('targetKmInput');
            const targetKm = parseFloat(targetInput.value);

            if (!targetKm || targetKm <= 0) {
                alert("ì˜¬ë°”ë¥¸ ëª©í‘œ ê±°ë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }

            // ì‚¬ìš©ì ì •ë³´ ì™„ì„± ë° ì €ì¥
            currentUser.targetKm = targetKm;
            appData.users[currentUser.id] = currentUser;
            saveAppData();

            // ë©”ì¸ í™”ë©´ ì—…ë°ì´íŠ¸ ë° ê¸°ë¡ ëª¨ë‹¬ë¡œ ì´ë™
            updateVisuals(currentUser.totalKm, currentUser.targetKm);
            prepareRecordModal();
        }

        // 4. ê¸°ë¡ ëª¨ë‹¬ ì¤€ë¹„ ë° í‘œì‹œ
        function prepareRecordModal() {
            document.getElementById('current-username').innerText = currentUser.name;
            document.getElementById('inputKm').value = ""; // ê±°ë¦¬ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            showModal('record');
        }

        // 5. ê¸°ë¡ ì œì¶œ (ì €ì¥)
        function submitRecord() {
            if (!currentUser) return; // ì•ˆì „ ì¥ì¹˜

            const kmInput = document.getElementById('inputKm');
            let addedKm = parseFloat(kmInput.value) || 0;
            if (addedKm <= 0) { closeAllModals(); return; }

            const startKm = currentUser.totalKm;
            currentUser.totalKm += addedKm;
            // ë°ì´í„° ì €ì¥
            appData.users[currentUser.id] = currentUser;
            saveAppData();
            
            closeAllModals();

            // ì• ë‹ˆë©”ì´ì…˜ ë° ì—…ë°ì´íŠ¸
            gsap.to({ val: startKm }, {
                val: currentUser.totalKm,
                duration: 2.0,
                ease: "power3.inOut",
                onUpdate: function() { updateVisuals(this.targets()[0].val, currentUser.targetKm); },
                onComplete: () => {
                    gsap.fromTo(marker.scale, {x:1, y:1}, {x:2.5, y:2.5, duration: 0.5, yoyo:true, repeat:1, ease:"back.out(2)"});
                    setTimeout(showBibleVerse, 800);
                }
            });
        }

        // === ëª¨ë‹¬ ê´€ë¦¬ ìœ í‹¸ë¦¬í‹° ===
        function showModal(modalName) {
            document.getElementById('modal-backdrop').classList.remove('hidden');
            ['login', 'register', 'record'].forEach(name => {
                const el = document.getElementById(`${name}-modal`);
                if (name === modalName) el.classList.remove('hidden');
                else el.classList.add('hidden');
            });
        }

        function closeAllModals() {
            document.getElementById('modal-backdrop').classList.add('hidden');
            document.querySelectorAll('#modal-backdrop > div').forEach(el => el.classList.add('hidden'));
        }

        // === ê¸°íƒ€ ê¸°ëŠ¥ ===
        function showBibleVerse() {
            const verses = [
                { text: "ì´ê¸°ê¸°ë¥¼ ë‹¤íˆ¬ëŠ” ìë§ˆë‹¤ ëª¨ë“  ì¼ì— ì ˆì œí•˜ë‚˜ë‹ˆ", ref: "ê³ ë¦°ë„ì „ì„œ 9:25" },
                { text: "ë‚´ê°€ ì„ í•œ ì‹¸ì›€ì„ ì‹¸ìš°ê³  ë‚˜ì˜ ë‹¬ë ¤ê°ˆ ê¸¸ì„ ë§ˆì³¤ìœ¼ë‹ˆ", ref: "ë””ëª¨ë°í›„ì„œ 4:7" },
                { text: "í‘¯ëŒ€ë¥¼ í–¥í•˜ì—¬ ê·¸ë¦¬ìŠ¤ë„ ì˜ˆìˆ˜ ì•ˆì—ì„œ ë‹¬ë ¤ê°€ë…¸ë¼", ref: "ë¹Œë¦½ë³´ì„œ 3:14" },
                { text: "ì¸ë‚´ë¡œì¨ ìš°ë¦¬ ì•ì— ë‹¹í•œ ê²½ì£¼ë¥¼ í•˜ë©°", ref: "íˆë¸Œë¦¬ì„œ 12:1" }
            ];
            const v = verses[Math.floor(Math.random() * verses.length)];
            document.getElementById('bible-text').innerText = v.text;
            document.getElementById('bible-ref').innerText = v.ref;
            document.getElementById('bible-modal').classList.remove('hidden');
        }

        function closeBible() { document.getElementById('bible-modal').classList.add('hidden'); }

        // === ë©”ì¸ ë£¨í”„ ===
        function animate() { 
            requestAnimationFrame(animate); 
            // **ë³€ê²½: ì§€êµ¬ê°€ ìŠ¤ìŠ¤ë¡œ íšŒì „** (ë¹›ì˜ ê¶¤ì ì€ ì¥ë©´ì— ê³ ì •ë¨)
            if(globe) globe.rotation.y -= 0.0015; // ìŒìˆ˜ë©´ ì‹œê³„ë°©í–¥ íšŒì „ì²˜ëŸ¼ ë³´ì„
            controls.update(); 
            renderer.render(scene, camera); 
        }

        window.addEventListener('resize', () => { 
            camera.aspect = window.innerWidth / window.innerHeight; 
            camera.updateProjectionMatrix(); 
            renderer.setSize(window.innerWidth, window.innerHeight); 
        });

        init3D();
    </script>
</body>
</html>
