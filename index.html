<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>2026 대학청년부 분과 드래프트 (최종)</title>
    <style>
        /* --- CSS Start --- */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
        }

        .container {
            display: flex;
            gap: 20px;
        }

        .draft-area {
            flex: 3;
            overflow-x: auto;
        }

        .roster-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* --- 테이블 스타일 --- */
        table {
            width: 100%;
            border-collapse: collapse;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            min-width: 800px;
        }

        th, td {
            border: 1px solid #ccc;
            padding: 5px;
            text-align: center;
            min-width: 60px;
            vertical-align: top;
        }

        thead th {
            background-color: #333;
            color: white;
            font-size: 0.9em;
        }

        /* 티어별 배경색 (테이블 줄) */
        .darkgray-bg { background-color: darkgray; }
        .lightgray-bg-row { background-color: lightgray; }
        .red-bg { background-color: #ffcccc; }
        .lightgreen-bg-row { background-color: #e6ffe6; }
        .yellow-bg-row { background-color: #ffffcc; }


        /* --- 드래프트 칸 스타일 --- */
        .draft-slots {
            display: flex;
            flex-direction: column;
            gap: 2px;
            padding: 2px 0;
        }
        
        .draft-slot {
            height: 30px;
            border: 1px solid #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
            color: #333; /* 기본 텍스트 색상 */
        }
        
        .draft-slot.blank {
            cursor: pointer;
            color: #007bff; /* 우선순위 번호 색상 */
        }

        .draft-slot.blank.filled {
            font-weight: normal;
            font-size: 1em;
            cursor: default;
            color: #333;
            border: 1px solid #aaa;
        }
        
        /* 칸 배경색 (요청에 따른 연차별 색상) */
        .lightgreen-bg-slot { background-color: #ccffcc; } /* 전임 3년차 (연한 초록) */
        .lightyellow-bg-slot { background-color: #ffffcc; } /* 전임 1~2년차 (연한 노랑) */
        .lightcoral-bg-slot { background-color: #ffdddd; } /* 파트 3년차 (연한 빨강) */
        .lightblue-bg-slot { background-color: #cceeff; } /* 파트 2년차 (연한 파랑) */
        .lightgray-bg-slot { background-color: #eeeeee; } /* 파트 1년차 (연한 회색) */

        /* 드래그 오버 효과 */
        .draft-slot.blank.drag-over {
            box-shadow: 0 0 10px 3px rgba(0, 123, 255, 0.6) inset;
        }
        
        /* --- 버튼 스타일 --- */
        .priority-btn {
            padding: 5px 10px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 1.2em;
        }

        .priority-btn:hover {
            background-color: #0056b3;
        }

        /* --- 명단 스티커 스타일 --- */
        #roster-area-sections {
            border: 1px solid #ccc;
            padding: 10px;
            background-color: #fff;
        }
        
        .roster-section {
            margin-bottom: 10px;
            padding: 5px;
            border-bottom: 1px solid #eee;
        }
        
        .roster-section h3 {
            margin: 5px 0;
            font-size: 1.1em;
            border-left: 5px solid #007bff;
            padding-left: 5px;
        }

        .name-sticker {
            display: inline-block;
            padding: 8px 12px;
            margin: 4px;
            border: 1px solid #ffd54f;
            border-radius: 5px;
            cursor: grab;
            font-weight: bold;
            box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
            opacity: 1;
            transition: opacity 0.3s;
        }

        /* 스티커 배경색 (요청에 따른 연차별 색상) */
        .sticker-A { background-color: #ccffcc; } /* 연한 초록 */
        .sticker-B { background-color: #ffffcc; } /* 연한 노랑 */
        .sticker-C { background-color: #ffdddd; } /* 연한 빨강 */
        .sticker-D { background-color: #cceeff; } /* 연한 파랑 */
        .sticker-E { background-color: #eeeeee; } /* 연한 회색 */

        .name-sticker.dragging {
            opacity: 0.7;
        }

        .name-sticker.hidden {
            display: none;
        }
        /* --- CSS End --- */
    </style>
</head>
<body>

    <header>
        <h1>2026 대학청년부 분과 드래프트</h1>
    </header>

    <div class="container">
        <div class="draft-area">
            <table>
                <thead>
                    <tr>
                        <th>연차</th>
                        <th>기획(최대총)</th>
                        <th>예배(강태양)</th>
                        <th>양육(신경훈)</th>
                        <th>선교(조은영)</th>
                        <th>사역(전진)</th>
                        <th>캠퍼스(오현교)</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr data-tier="A" class="darkgray-bg">
                        <td>전임 3년차~</td>
                        <td></td>
                        <td></td>
                        <td>
                            <div class="draft-slots"><div class="draft-slot blank lightgreen-bg-slot" data-col="양육" data-tier="A" data-slot-order="1"></div></div>
                        </td>
                        <td>
                            <div class="draft-slots">
                                <div class="draft-slot blank lightgreen-bg-slot" data-col="선교" data-tier="A" data-slot-order="1"></div>
                                <div class="draft-slot blank lightgreen-bg-slot" data-col="선교" data-tier="A" data-slot-order="2"></div>
                            </div>
                        </td>
                        <td>
                            <div class="draft-slots"><div class="draft-slot blank lightgreen-bg-slot" data-col="사역" data-tier="A" data-slot-order="1"></div></div>
                        </td>
                        <td></td>
                        <td><button class="priority-btn" data-tier="A">➡️</button></td>
                    </tr>
                    <tr data-tier="B" class="lightgray-bg-row">
                        <td>전임 1~2년차</td>
                        <td>
                            <div class="draft-slots"><div class="draft-slot blank lightyellow-bg-slot" data-col="기획" data-tier="B" data-slot-order="1"></div></div>
                        </td>
                        <td>
                            <div class="draft-slots"><div class="draft-slot blank lightyellow-bg-slot" data-col="예배" data-tier="B" data-slot-order="1"></div></div>
                        </td>
                        <td>
                            <div class="draft-slots">
                                <div class="draft-slot blank lightyellow-bg-slot" data-col="양육" data-tier="B" data-slot-order="1"></div>
                                <div class="draft-slot blank lightyellow-bg-slot" data-col="양육" data-tier="B" data-slot-order="2"></div>
                            </div>
                        </td>
                        <td>
                            <div class="draft-slots"><div class="draft-slot blank lightyellow-bg-slot" data-col="선교" data-tier="B" data-slot-order="1"></div></div>
                        </td>
                        <td>
                            <div class="draft-slots"><div class="draft-slot blank lightyellow-bg-slot" data-col="사역" data-tier="B" data-slot-order="1"></div></div>
                        </td>
                        <td></td>
                        <td><button class="priority-btn" data-tier="B">➡️</button></td>
                    </tr>
                    <tr data-tier="C" class="red-bg">
                        <td>파트 3년차</td>
                        <td></td>
                        <td>
                            <div class="draft-slots"><div class="draft-slot blank lightcoral-bg-slot" data-col="예배" data-tier="C" data-slot-order="1"></div></div>
                        </td>
                        <td>
                            <div class="draft-slots"><div class="draft-slot blank lightcoral-bg-slot" data-col="양육" data-tier="C" data-slot-order="1"></div></div>
                        </td>
                        <td>
                            <div class="draft-slots"><div class="draft-slot blank lightcoral-bg-slot" data-col="선교" data-tier="C" data-slot-order="1"></div></div>
                        </td>
                        <td>
                            <div class="draft-slots"><div class="draft-slot blank lightcoral-bg-slot" data-col="사역" data-tier="C" data-slot-order="1"></div></div>
                        </td>
                        <td></td>
                        <td><button class="priority-btn" data-tier="C">➡️</button></td>
                    </tr>
                    <tr data-tier="D" class="lightgreen-bg-row">
                        <td>파트 2년차</td>
                        <td></td>
                        <td>
                            <div class="draft-slots">
                                <div class="draft-slot blank lightblue-bg-slot" data-col="예배" data-tier="D" data-slot-order="1"></div>
                                <div class="draft-slot blank lightblue-bg-slot" data-col="예배" data-tier="D" data-slot-order="2"></div>
                            </div>
                        </td>
                        <td>
                            <div class="draft-slots">
                                <div class="draft-slot blank lightblue-bg-slot" data-col="양육" data-tier="D" data-slot-order="1"></div>
                                <div class="draft-slot blank lightblue-bg-slot" data-col="양육" data-tier="D" data-slot-order="2"></div>
                            </div>
                        </td>
                        <td>
                            <div class="draft-slots"><div class="draft-slot blank lightblue-bg-slot" data-col="선교" data-tier="D" data-slot-order="1"></div></div>
                        </td>
                        <td>
                            <div class="draft-slots">
                                <div class="draft-slot blank lightblue-bg-slot" data-col="사역" data-tier="D" data-slot-order="1"></div>
                                <div class="draft-slot blank lightblue-bg-slot" data-col="사역" data-tier="D" data-slot-order="2"></div>
                            </div>
                        </td>
                        <td></td>
                        <td><button class="priority-btn" data-tier="D">➡️</button></td>
                    </tr>
                    <tr data-tier="E" class="yellow-bg-row">
                        <td>파트 1년차</td>
                        <td></td>
                        <td>
                            <div class="draft-slots">
                                <div class="draft-slot blank lightgray-bg-slot" data-col="예배" data-tier="E" data-slot-order="1"></div>
                                <div class="draft-slot blank lightgray-bg-slot" data-col="예배" data-tier="E" data-slot-order="2"></div>
                            </div>
                        </td>
                        <td></td>
                        <td>
                            <div class="draft-slots"><div class="draft-slot blank lightgray-bg-slot" data-col="선교" data-tier="E" data-slot-order="1"></div></div>
                        </td>
                        <td>
                            <div class="draft-slots"><div class="draft-slot blank lightgray-bg-slot" data-col="사역" data-tier="E" data-slot-order="1"></div></div>
                        </td>
                        <td></td>
                        <td><button class="priority-btn" data-tier="E">➡️</button></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="roster-area">
            <div id="roster-area-sections">
                <h2>드래프트 명단</h2>
                </div>

            <div class="roster-table-container">
                <h2>전임/파트 명단 (2026년 기준)</h2>
                <table>
                    <tr class="lightgreen-bg-row">
                        <td>전임 3년차~</td>
                        <td>박성원, 박성훈, 이진기, 최재윤</td>
                    </tr>
                    <tr class="yellow-bg-row">
                        <td>1~2년차</td>
                        <td>김현, 길한솔, 이승호, 최강호, 홍근영</td>
                    </tr>
                    <tr class="red-bg">
                        <td>파트 3년차~</td>
                        <td>구길모, 이예찬, 장건우, 정찬중</td>
                    </tr>
                    <tr class="lightgreen-bg-row">
                        <td>2년차</td>
                        <td>권혁성, 박시온, 박지윤, 배윤주, 오진우, 이은찬, 조영찬</td>
                    </tr>
                    <tr class="yellow-bg-row">
                        <td>1년차</td>
                        <td>이나단, 신지수, 김영범, 신입</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

    <script>
        /* --- JavaScript Start --- */
        document.addEventListener('DOMContentLoaded', () => {
            // 1. 명단 데이터 (업데이트된 명단 반영)
            const rosterData = {
                'A': { name: '전임 3년차~', list: ['박성원', '박성훈', '이진기', '최재윤'], count: 4, colorClass: 'sticker-A' },
                'B': { name: '전임 1~2년차', list: ['김현', '길한솔', '이승호', '최강호', '홍근영'], count: 5, colorClass: 'sticker-B' },
                'C': { name: '파트 3년차', list: ['구길모', '이예찬', '장건우', '정찬중'], count: 4, colorClass: 'sticker-C' },
                'D': { name: '파트 2년차', list: ['권혁성', '박시온', '박지윤', '배윤주', '오진우', '이은찬', '조영찬'], count: 7, colorClass: 'sticker-D' },
                'E': { name: '파트 1년차', list: ['이나단', '신지수', '김영범', '신입'], count: 4, colorClass: 'sticker-E' }
            };

            const sectionsContainer = document.getElementById('roster-area-sections');
            const priorityButtons = document.querySelectorAll('.priority-btn');
            const draftBlanks = document.querySelectorAll('.draft-slot.blank'); 

            // 빈칸 배열 (각 티어별 순서대로)
            const tierBlanks = {
                'A': document.querySelectorAll('.draft-slot.blank[data-tier="A"]'),
                'B': document.querySelectorAll('.draft-slot.blank[data-tier="B"]'),
                'C': document.querySelectorAll('.draft-slot.blank[data-tier="C"]'),
                'D': document.querySelectorAll('.draft-slot.blank[data-tier="D"]'),
                'E': document.querySelectorAll('.draft-slot.blank[data-tier="E"]'),
            };

            // Fisher-Yates 셔플 함수
            function shuffle(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }

            // 2. 명단 스티커 생성 (그룹화 및 색상 적용)
            function createStickers() {
                sectionsContainer.innerHTML = '<h2>드래프트 명단</h2>';
                for (const tier in rosterData) {
                    const section = document.createElement('div');
                    section.className = 'roster-section';
                    
                    const title = document.createElement('h3');
                    title.textContent = rosterData[tier].name;
                    section.appendChild(title);
                    
                    rosterData[tier].list.forEach(name => {
                        const sticker = document.createElement('div');
                        sticker.className = `name-sticker ${rosterData[tier].colorClass}`;
                        sticker.draggable = true;
                        sticker.textContent = name;
                        sticker.id = `sticker-${name}`;
                        sticker.setAttribute('data-tier', tier);
                        section.appendChild(sticker);
                    });
                    sectionsContainer.appendChild(section);
                }
            }

            // 3. 우선순위 부여 로직 (랜덤 및 형평성 규칙 적용)
            function setPriorities(tier) {
                const blanks = Array.from(tierBlanks[tier]).filter(b => !b.classList.contains('filled'));
                if (blanks.length === 0) return;

                // 1. 칸을 1순위 (각 분과의 첫 번째 칸)와 2순위 (남은 칸)로 분류
                const round1Slots = blanks.filter(b => b.getAttribute('data-slot-order') === '1');
                const round2Slots = blanks.filter(b => b.getAttribute('data-slot-order') === '2');
                
                const totalSlots = blanks.length;
                let priorities = Array.from({ length: totalSlots }, (_, i) => i + 1); // 1부터 N까지 순위
                priorities = shuffle(priorities); // 순위 랜덤 셔플

                let round1Priorities = priorities.slice(0, round1Slots.length);
                let round2Priorities = priorities.slice(round1Slots.length);
                
                round1Priorities = shuffle(round1Priorities); // 1라운드 순위 재셔플
                round2Priorities = shuffle(round2Priorities); // 2라운드 순위 재셔플

                // 2. 1순위 칸에 우선순위 부여 (모든 분과가 1순위씩 먼저 가져감)
                round1Slots.forEach((slot, index) => {
                    slot.textContent = round1Priorities[index];
                });

                // 3. 2순위 칸에 남은 우선순위 부여
                round2Slots.forEach((slot, index) => {
                    slot.textContent = round2Priorities[index];
                });

                // 4. 모든 칸에 순위가 부여된 후, '선교' 칸의 순위 재조정 (형평성 규칙 강화)
                // 이 코드에서는 '선교' 칸도 일반 2순위 칸과 동일하게 2라운드에서 뽑히므로, 추가적인 '전체 마지막 순위' 로직은 생략합니다.
                // *요청하신 '같은 분과에 칸이 두개가 있는 경우엔 남은 한 칸은 다른 분과가 우선순위 먼저 가져가고 번호 받게 해주고' 규칙이 '선교'에 대한 특정 규칙보다 상위 규칙으로 해석되었습니다.*
            }


            // 4. 화살표 버튼 이벤트 리스너
            priorityButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const tier = e.currentTarget.getAttribute('data-tier');
                    setPriorities(tier);
                });
            });

            // 5. 드래그 앤 드롭 이벤트 처리
            let draggedSticker = null;

            sectionsContainer.addEventListener('dragstart', (e) => {
                if (e.target.classList.contains('name-sticker')) {
                    draggedSticker = e.target;
                    e.dataTransfer.setData('text/plain', draggedSticker.textContent);
                    e.dataTransfer.setData('tier', draggedSticker.getAttribute('data-tier'));
                    setTimeout(() => {
                        draggedSticker.classList.add('dragging');
                    }, 0);
                }
            });

            sectionsContainer.addEventListener('dragend', () => {
                if (draggedSticker) {
                    draggedSticker.classList.remove('dragging');
                    draggedSticker = null;
                }
            });

            draftBlanks.forEach(blank => {
                blank.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    // 1. 순위가 부여되었는지 확인
                    // 2. 스티커의 티어와 칸의 티어가 일치하는지 확인
                    if (!blank.classList.contains('filled') && !isNaN(parseInt(blank.textContent)) && e.dataTransfer.getData('tier') === blank.getAttribute('data-tier')) {
                        blank.classList.add('drag-over');
                    }
                });

                blank.addEventListener('dragleave', () => {
                    blank.classList.remove('drag-over');
                });

                blank.addEventListener('drop', (e) => {
                    e.preventDefault();
                    blank.classList.remove('drag-over');
                    
                    const tierCheck = draggedSticker && draggedSticker.getAttribute('data-tier') === blank.getAttribute('data-tier');

                    if (draggedSticker && !blank.classList.contains('filled') && !isNaN(parseInt(blank.textContent)) && tierCheck) {
                        const name = draggedSticker.textContent;
                        
                        // 1. 칸 채우기
                        blank.textContent = name;
                        blank.classList.add('filled');
                        
                        // 2. 스티커 숨기기
                        draggedSticker.classList.add('hidden');
                        
                        // 참고: 드롭 후 순위 재조정 로직은 (랜덤 순위이므로) 필요하지 않음.
                    }
                });
            });

            // 초기화 및 실행
            createStickers();
        });
        /* --- JavaScript End --- */
    </script>
</body>
</html>
